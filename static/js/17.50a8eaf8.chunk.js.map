{"version":3,"sources":["pages/dashboard/settings/profile.tsx","API/useProfile.tsx"],"names":["ProfileSetting","useState","isUser","setUser","isCompany","setCompany","profile","isLoading","setLoading","storage","useSelector","selectStorage","data","useFirestoreRead","auth","currentUser","uid","address","id","name","decryptMessage","encryptedMessageToken","surname","companyName","timestamp","UpdateNameSurname","a","FirestoreWrite","updateDoc","encryptMessage","UpdateCompany","company","useProfile","update","e","preventDefault","target","value","console","error","className","onSubmit","type","defaultValue"],"mappings":"uNA0EeA,UArEQ,WACnB,MAA0BC,oBAAS,GAAnC,mBAAOC,EAAP,KAAeC,EAAf,KACA,EAAgCF,oBAAS,GAAzC,mBAAOG,EAAP,KAAkBC,EAAlB,KAEA,ECFW,WACb,IAIIC,EAJJ,EAAgCL,oBAAS,GAAzC,mBAAOM,EAAP,KAAkBC,EAAlB,KACMC,EAAUC,YAAYC,KAEtBC,EAASC,YAAwB,QAASC,IAAKC,YAAaC,KAA5DJ,KAEFA,IACFN,EAAU,CACRW,QAASL,EAAMK,QACfC,GAAIN,EAAMM,GACVC,KAAMC,YAAeR,EAAMO,KAAMV,EAASY,uBAC1CC,QAASF,YAAeR,EAAMU,QAASb,EAASY,uBAChDE,YAAaH,YAAeR,EAAMW,YAAad,EAASY,uBACxDG,UAAWZ,EAAMY,YAIrB,IAAMC,EAAiB,uCAAG,WAAON,EAAcG,GAArB,SAAAI,EAAA,6DACxBlB,GAAW,GADa,SAElBmB,cAGDC,UAAU,QAASd,IAAKC,YAAaC,IAAK,CAC7CG,KAAMU,YAAeV,EAAD,OAAOV,QAAP,IAAOA,OAAP,EAAOA,EAASY,uBACpCC,QAASO,YAAeP,EAAD,OAAUb,QAAV,IAAUA,OAAV,EAAUA,EAASY,yBAPpB,OASxBb,GAAW,GATa,2CAAH,wDAYjBsB,EAAa,uCAAG,WAAOC,GAAP,SAAAL,EAAA,6DACpBlB,GAAW,GADS,SAEdmB,cAEDC,UAAU,QAASd,IAAKC,YAAaC,IAAK,CAC7CO,YAAaM,YAAeE,EAAD,OAAUtB,QAAV,IAAUA,OAAV,EAAUA,EAASY,yBAL5B,OAOpBb,GAAW,GAPS,2CAAH,sDAWnB,MAAO,CAAED,YAAWuB,gBAAeL,oBAAmBnB,WDtCa0B,GAA9CF,GAAnB,EAAQvB,UAAR,EAAmBuB,eAAeL,EAAlC,EAAkCA,kBAAmBnB,EAArD,EAAqDA,QAE/C2B,EAAM,uCAAG,WAAOC,GAAP,qBAAAR,EAAA,yDACXQ,EAAEC,iBADS,EAG8DD,EAAEE,OAAnEjB,EAHG,EAGHA,KAAMG,EAHH,EAGGA,QAASS,EAHZ,EAGYA,QAHZ,UAKHZ,IAAQG,GAAYS,EALjB,wBAMH5B,GAAQ,GANL,SAOGsB,EAAkBN,EAAKkB,MAAOf,EAAQe,OAPzC,OAQHlC,GAAQ,GARL,4BASI4B,GAAYZ,GAASG,EATzB,wBAUHjB,GAAW,GAVR,UAWGyB,EAAcC,EAAQM,OAXzB,QAYHhC,GAAW,GAZR,0DAePiC,QAAQC,MAAR,MACAlC,GAAW,GACXF,GAAQ,GAjBD,0DAAH,sDAqBZ,OAAO,sBAAKqC,UAAU,qCAAf,UACH,gCACI,qBAAKA,UAAU,UAAf,qBACA,qBAAKA,UAAU,UAAf,kCAEHlC,EACG,qCACI,qBAAKkC,UAAU,0BAAf,SACI,uBAAMC,SAAUR,EAAhB,UACI,gDACA,sBAAKO,UAAU,4CAAf,UACI,sBAAKA,UAAU,2BAAf,UACI,8BACI,uBAAOE,KAAK,OAAOC,aAAY,OAAErC,QAAF,IAAEA,OAAF,EAAEA,EAASa,KAAMA,KAAK,OAAOqB,UAAU,+DAE1E,8BACI,uBAAOE,KAAK,OAAOvB,KAAK,UAAUwB,aAAY,OAAErC,QAAF,IAAEA,OAAF,EAAEA,EAASgB,QAASkB,UAAU,kEAGpF,qBAAKA,UAAU,YAAf,SACI,cAAC,IAAD,CAAQE,KAAK,SAASF,UAAU,oBAAoBjC,UAAWL,EAA/D,8BAKhB,qBAAKsC,UAAU,0BAAf,SACI,uBAAMC,SAAUR,EAAhB,UACI,oDACA,sBAAKO,UAAU,4CAAf,UACI,qBAAKA,UAAU,YAAf,SACI,uBAAOE,KAAK,OAAOvB,KAAK,UAAUwB,aAAY,OAAErC,QAAF,IAAEA,OAAF,EAAEA,EAASiB,YAAaiB,UAAU,sEAEpF,8BACI,cAAC,IAAD,CAAQE,KAAK,SAASF,UAAU,aAAajC,UAAWH,EAAxD,iCAKd,sBAAKoC,UAAU,sBAAf,cAAsC,cAAC,aAAD,IAAtC","file":"static/js/17.50a8eaf8.chunk.js","sourcesContent":["import { FormEvent, useEffect, useState } from \"react\";\nimport { ClipLoader } from \"react-spinners\";\nimport Button from \"components/button\";\nimport useProfile from \"API/useProfile\";\n\nconst ProfileSetting = () => {\n    const [isUser, setUser] = useState(false)\n    const [isCompany, setCompany] = useState(false)\n\n    const { isLoading, UpdateCompany, UpdateNameSurname, profile } = useProfile()\n\n    const update = async (e: FormEvent<HTMLFormElement>) => {\n        e.preventDefault()\n\n        const { name, surname, company }: { [name: string]: HTMLInputElement } = e.target as HTMLFormElement;\n        try {\n            if (name && surname && !company) {\n                setUser(true)\n                await UpdateNameSurname(name.value, surname.value)\n                setUser(false)\n            } else if (company && !name && !surname) {\n                setCompany(true)\n                await UpdateCompany(company.value)\n                setCompany(false)\n            }\n        } catch (error) {\n            console.error(error)\n            setCompany(false)\n            setUser(false)\n        }\n    }\n\n    return <div className=\"px-3 py-5 flex flex-col space-y-10\">\n        <div>\n            <div className=\"text-lg\">Profile</div>\n            <div className=\"text-sm\">Edit your account</div>\n        </div>\n        {profile ?\n            <>\n                <div className=\"flex flex-col space-y-3\">\n                    <form onSubmit={update}>\n                        <div>Personal Name</div>\n                        <div className=\"flex space-x-4 items-center max-w-[600px]\">\n                            <div className=\"grid grid-cols-2 gap-x-4\">\n                                <div>\n                                    <input type=\"text\" defaultValue={profile?.name} name=\"name\" className=\"border px-2 py-2 outline-none border-gray-700 rounded-lg\" />\n                                </div>\n                                <div>\n                                    <input type=\"text\" name=\"surname\" defaultValue={profile?.surname} className=\"border px-2 py-2 outline-none border-gray-700 rounded-lg\" />\n                                </div>\n                            </div>\n                            <div className=\"flex-grow\">\n                                <Button type=\"submit\" className=\"px-12 py-2 w-full\" isLoading={isUser}>Update</Button>\n                            </div>\n                        </div>\n                    </form>\n                </div>\n                <div className=\"flex flex-col space-y-3\">\n                    <form onSubmit={update}>\n                        <div>Organization Name</div>\n                        <div className=\"flex space-x-4 items-center max-w-[600px]\">\n                            <div className=\"flex-grow\">\n                                <input type=\"text\" name=\"company\" defaultValue={profile?.companyName} className=\"border px-2 py-2 outline-none border-gray-700 rounded-lg w-full\" />\n                            </div>\n                            <div>\n                                <Button type=\"submit\" className=\"px-12 py-2\" isLoading={isCompany}>Update</Button>\n                            </div>\n                        </div>\n                    </form>\n                </div>\n            </> : <div className=\"flex justify-center\"> <ClipLoader /> </div>}\n    </div>\n}\n\nexport default ProfileSetting;","import { auth, IUser } from 'firebase';\r\nimport { useState } from 'react';\r\nimport { useSelector } from 'react-redux';\r\nimport { selectStorage } from 'redux/reducers/storage';\r\nimport { decryptMessage, encryptMessage } from 'utils/hashing';\r\nimport { FirestoreWrite, useFirestoreRead } from './useFirebase';\r\n\r\nexport default function useProfile() {\r\n  const [isLoading, setLoading] = useState(false)\r\n  const storage = useSelector(selectStorage)\r\n\r\n  let { data } = useFirestoreRead<IUser>('users', auth.currentUser!.uid)\r\n  let profile: IUser | undefined;\r\n  if (data) {\r\n    profile = {\r\n      address: data!.address,\r\n      id: data!.id,\r\n      name: decryptMessage(data!.name, storage!.encryptedMessageToken),\r\n      surname: decryptMessage(data!.surname, storage!.encryptedMessageToken),\r\n      companyName: decryptMessage(data!.companyName, storage!.encryptedMessageToken),\r\n      timestamp: data!.timestamp\r\n    }\r\n  }\r\n\r\n  const UpdateNameSurname = async (name: string, surname: string) => {\r\n    setLoading(true)\r\n    await FirestoreWrite<{\r\n      name: string,\r\n      surname: string,\r\n    }>().updateDoc(\"users\", auth.currentUser!.uid, {\r\n      name: encryptMessage(name, storage?.encryptedMessageToken),\r\n      surname: encryptMessage(surname, storage?.encryptedMessageToken),\r\n    })\r\n    setLoading(false)\r\n  }\r\n\r\n  const UpdateCompany = async (company: string) => {\r\n    setLoading(true)\r\n    await FirestoreWrite<{\r\n      companyName: string,\r\n    }>().updateDoc(\"users\", auth.currentUser!.uid, {\r\n      companyName: encryptMessage(company, storage?.encryptedMessageToken),\r\n    })\r\n    setLoading(false)\r\n  }\r\n\r\n\r\n  return { isLoading, UpdateCompany, UpdateNameSurname, profile }\r\n};\r\n"],"sourceRoot":""}